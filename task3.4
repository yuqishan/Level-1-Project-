import matplotlib.pyplot as plt
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg, NavigationToolbar2Tk
import tkinter as tk
from tkinter import ttk
import pandas as pd

# Load data
df = pd.read_csv("data.csv")
df["Time"] = df["Time"]

# All the units of different parameters measured
units = {
    "Temperature": "Celsius",
    "Pressure": "Pa",
    "Humidity": "%",
    "IQAScore": "0-351",
    "eCO2Value": "PPM"
}

# Function to update the plot
def update_plot():
    ax.clear()
    graph_type = dropdown.get()
    ax.plot(df["Time"].tolist(), df[graph_type].tolist())
    ax.set_title(graph_type)
    ax.set_xlabel("Uptime (Seconds)")
    ax.set_ylabel(f"{graph_type} ({units[graph_type]})")
    canvas.draw()

# Create the main window
root = tk.Tk()
root.title("Results Graphed")

# Create a figure and axis
fig, ax = plt.subplots()

# Initialize the plot
ax.plot(df["Time"].tolist(), df["Temperature"].tolist())

# Create a canvas for the plot
canvas = FigureCanvasTkAgg(fig, master=root)
canvas.draw()
canvas.get_tk_widget().pack(side=tk.TOP, fill=tk.BOTH, expand=1)

# Create a navigation toolbar
toolbar = NavigationToolbar2Tk(canvas, root)
toolbar.update()
canvas.get_tk_widget().pack(side=tk.TOP, fill=tk.BOTH, expand=1)

# Create a dropdown menu
dropdown = ttk.Combobox(root, values=["Temperature", "Humidity", "Pressure", "IQAScore", "eCO2Value"])
dropdown.current(0)  # Set default value
dropdown.pack(side=tk.BOTTOM)

# Bind the dropdown menu to the update function
dropdown.bind("<<ComboboxSelected>>", lambda event: update_plot())

# Call update_plot once to initialize the plot
update_plot()

# Start the Tkinter main loop
root.mainloop()
